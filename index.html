<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>라스트 워 VS 마스터 v8.5</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-firestore-compat.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="header-bar">
        <div class="logo">ALLIANCE MASTER</div>
        <div style="display: flex; align-items: center; gap: 15px;">
            <div class="lang-selector" style="font-size: 0.8rem; font-weight: 800; cursor: pointer;">
                <span id="lang-ko" onclick="changeLang('ko')" style="color: var(--primary);">KO</span> | 
                <span id="lang-en" onclick="changeLang('en')" style="color: #94a3b8;">EN</span>
            </div>
            <div class="live-counter"><div class="live-dot"></div><span id="user-count">연결 중...</span></div>
        </div>
    </div>

    <nav class="nav-bar">
        <div id="nav-calc" class="nav-item active" onclick="showPage('calc')">📊 계산기</div>
        <div id="nav-board" class="nav-item" onclick="showPage('board')">📱 피드</div>
        <div id="nav-qna" class="nav-item" onclick="showPage('qna')">💬 건의</div>
    </nav>

    <div class="container">
        <div id="page-calc" class="page-content active">
            <div class="card">
                <div class="section-title">🎯 DAILY GOAL</div>
                <div class="target-selector">
                    <button class="target-btn" id="target-2300000" onclick="setTarget(2300000)">6상</button>
                    <button class="target-btn" id="target-3600000" onclick="setTarget(3600000)">8상</button>
                    <button class="target-btn active" id="target-7200000" onclick="setTarget(7200000)">9상</button>
                </div>
            </div>
            <div class="card">
                <div class="section-title">🔬 ALLIANCE TECH</div>
                <div class="tech-grid" id="tech-inputs"></div>
            </div>
            <div class="day-tabs" id="day-tabs-container"></div>
            <div id="input-container"></div>
        </div>
        <div id="page-board" class="page-content"><div id="posts-list"></div></div>
        <div id="page-qna" class="page-content"><div id="suggestions-list"></div></div>
    </div>

    <div class="result-bar">
        <div class="total-score" id="score">0.0</div>
        <div class="progress-container"><div class="progress-fill" id="bar"></div></div>
        <div id="diff" style="font-size:0.85rem; color:#cbd5e1; font-weight:600;">남은 점수: 7,200,000</div>
    </div>

    <div id="float-btn" class="write-btn" style="display:none;" onclick="openModal()">+</div>
    

    <div id="viewModal" class="modal">
        <div class="modal-card">
            <span class="close-x" onclick="closeViewModal()">&times;</span>
            <div id="view-body" style="margin-top:20px;">
                <div id="view-content"></div>
                <img id="view-img" style="width:100%; border-radius:12px; margin:20px 0; display:none;">
            </div>
            <div style="display:flex; gap:15px; margin-top:20px; border-top:1px solid #eee; padding-top:20px;">
                <span onclick="toggleReplySection()" style="cursor:pointer; color:var(--primary); font-weight:800; font-size:0.9rem;">💬 댓글</span>
                <span id="edit-link" style="display:none; cursor:pointer; color:var(--text-muted); font-size:0.9rem;" onclick="prepareEdit()">✏️ 수정</span>
            </div>
            <div id="reply-container" style="display:none; margin-top:20px;">
                <div id="view-replies" class="reply-section"></div>
                <div class="reply-input-group">
                    <input type="text" id="view-reply-input" class="reply-input" placeholder="의견을 남겨주세요...">
                    <button id="view-reply-btn" class="btn-primary" style="padding:10px 15px;">등록</button>
                </div>
            </div>
            <div id="delete-area" style="display:none; text-align:right; margin-top:30px;">
                <span style="font-size:0.75rem; color:#ccc; cursor:pointer;" onclick="deleteCurrentPost()">게시물 삭제</span>
            </div>
        </div>
    </div>

<div id="spdModal" class="modal">
    <div class="modal-card">
        <span class="close-x" onclick="closeSpdModal()">&times;</span>
        <h3 id="spd-title" style="margin-top:0; margin-bottom:20px;">가속 계산기</h3>
        <div class="tech-grid">
            <div class="tech-item">
                <label id="lbl-m5">5분</label>
                <input type="number" id="m5" class="compact-input" value="0" min="0" oninput="validatePos(this); calcSpdTotal()">
            </div>
            <div class="tech-item">
                <label id="lbl-m15">15분</label>
                <input type="number" id="m15" class="compact-input" value="0" min="0" oninput="validatePos(this); calcSpdTotal()">
            </div>
            <div class="tech-item">
                <label id="lbl-h1">1시간</label>
                <input type="number" id="h1" class="compact-input" value="0" min="0" oninput="validatePos(this); calcSpdTotal()">
            </div>
            <div class="tech-item">
                <label id="lbl-h3">3시간</label>
                <input type="number" id="h3" class="compact-input" value="0" min="0" oninput="validatePos(this); calcSpdTotal()">
            </div>
            <div class="tech-item" style="grid-column: span 2;">
                <label id="lbl-h8">8시간</label>
                <input type="number" id="h8" class="compact-input" value="0" min="0" oninput="validatePos(this); calcSpdTotal()">
            </div>
        </div>
        <div id="spd-result-text" style="margin: 25px 0; text-align: center; color: var(--primary); font-weight: 800; font-size: 1.3rem;">총: 0일 0시 0분</div>
        <div style="display:grid; grid-template-columns: 1fr 2fr; gap:12px">
            <button onclick="closeSpdModal()" class="btn-secondary">취소</button>
            <button onclick="applySpd()" class="btn-primary">적용하기</button>
        </div>
    </div>
</div>

<div id="writeModal" class="modal">
    <div class="modal-card">
        <span class="close-x" onclick="closeModal()">&times;</span>
        <h3 id="modal-title" style="margin-top:0; margin-bottom:20px;">전략 공유하기 🖋️</h3>
        <input type="hidden" id="edit-doc-id">
        <input type="text" id="post-title" class="modern-input" placeholder="제목을 입력하세요">
        <textarea id="post-content" class="modern-textarea" placeholder="공략 내용을 입력하세요"></textarea>
        
        <div class="file-upload-wrapper" style="margin-bottom:20px;">
            <label for="post-file" class="custom-file-upload">🖼️ 이미지 첨부</label>
            <input type="file" id="post-file" accept="image/*" onchange="updateFileName(this)">
            <span id="file-name" style="font-size:0.8rem; color:var(--text-muted); margin-left:10px;">선택된 파일 없음</span>
        </div>
        
        <button onclick="sendLivePost()" class="btn-primary modern-submit" style="width:100%;" id="submit-btn">게시하기</button>
    </div>
</div>

    <div class="admin-link" onclick="enableAdmin()">🛡️ Admin Mode</div>

    <script src="calc.js"></script>
    <script src="board.js"></script>
</body>
</html>
